{"version":3,"file":"js/573.js","mappings":"oQAyEiD,EAAY,K,wCAAnD,YAAyD,Q,0DAAlB,EAAY,K,8SADhD,EAAY,S,+/BANrB,YAaS,QAZP,YAWM,MAVJ,YAA6B,M,kBAC7B,YAA0E,M,kBAC1E,YAAsC,M,kBACtC,YAA+G,M,mDAI/G,YAAmC,M,kBACnC,YAAiE,M,kBACjE,YAAmD,K,2CANO,EAAY,K,uBAAa,EAAa,K,cAC3F,EAAY,G,iXARuD,U,oRAAjEA,OAAOC,KAAO,a,yEAFzB,YAGK,QADH,YAA6F,M,ktBAhElF,0C,sRAOXC,EACAC,EAAe,G,SAiBVC,IAhBoBC,IAAAA,GAAAA,EAiBbC,KAAKC,MAjByB,oC,GAC5CC,QAAQC,IAAIJ,IACPA,EAAO,MAAO,G,GACfA,EAAMK,WAAW,QAAUL,EAAMM,OAAS,G,MACrC,8C,GAELN,EAAMK,WAAW,MAAQL,EAAMM,OAAS,G,MACnC,gD,MAEHC,QAAoB,IAAAC,QAAO,aAAc,CAAER,MAAAA,I,OAC5CO,EAGI,gCAAkCA,EAFlC,OAMiBE,MAAKC,GAAOT,KAAKU,kBAAkB,EAAD,EAAEb,EAAeY,M,MAEzEE,GAAmB,IAAAC,UAASd,G,OAclC,IAAAe,UAAQ,IACNjB,EAAKkB,iBAAiB,UAAUC,IAC9BA,EAAGC,iB,MACGC,EAAW,IAAIC,SAAStB,IAC9B,IAAAW,QAAO,eAAgB,CACrBY,KAAMF,EAASG,IAAI,QACnBrB,MAAOkB,EAASG,IAAI,SACpBC,QAASJ,EAASG,IAAI,aACrBZ,MAAKC,I,MACDA,EAAIa,MACPC,MAAM,sBAEsB,QAA9B,EAAA7B,OAAO,iBAAiB8B,cAAM,SAAEC,MAAM,oB,sBAxBrCzB,KAAKC,MAAO,O,IACbyB,EAAa1B,KAAKC,MACtByB,GAAMA,EAAGtB,WAAW,KAAO,IAAM,IAAMsB,EAAGC,QAAQ,UAAW,IAAIC,OAC3DF,EAAGtB,WAAW,MAAQsB,EAAGtB,WAAW,OAAOsB,EAAK,MAAQA,GAC1DA,EAAGtB,WAAW,QAAUsB,EAAGrB,OAAS,IAAGqB,EAAK,OAASA,EAAGG,MAAM,EAAG,KACjEH,EAAGtB,WAAW,OACZsB,EAAGrB,OAAS,IAAGqB,EAAKA,EAAGG,MAAM,EAAG,GAAK,IAAMH,EAAGG,MAAM,EAAG,KACvDH,EAAGrB,OAAS,IAAGqB,EAAKA,EAAGG,MAAM,EAAG,GAAK,IAAMH,EAAGG,MAAM,EAAG,MAE7D7B,KAAKC,MAAQyB,EACbf,EAAiBmB,MAAM9B,O,0DA2BJJ,EAAI,E,ubClDnB,YAAqG,Q,kEAFlG,EAAU,Q,kOAIO,EAAO,I,mQANjC,YAaK,QAZH,YAOK,K,kCAFH,YAAmC,M,qEAIrC,YAEK,K,8BAVE,EAAU,G,yEAIO,EAAO,I,2rBAhB3BmC,GAAQ,e,IACVC,EAAeD,EAAME,Q,4CACzBF,EAAMG,OAAOC,KAAKC,G,eACPC,GAAsB,GAAK,G,QAC3BC,GAAe,E,OAC1BC,SAASC,KAAKC,UAAY,EAC1BF,SAASG,gBAAgBD,UAAY,E,oRCThC,SAAS7B,EACd+B,EACAC,EAAgB,KAEhB,IAAIC,EACJ,OAAO,YAA4BC,GACjC,MAAMC,EAAU/C,KAChBgD,aAAaH,GACbA,EAAgBI,YAAW,IAAMN,EAAKb,MAAMiB,EAASD,IAAOF,I","sources":["webpack:///./src/routes/Clients/Add.svelte","webpack:///./theme/Page.svelte","webpack:///./src/utils.ts"],"sourcesContent":["<script lang=\"ts\">\n  import { action } from '@/api';\n  import { debounce } from '@/utils';\n  import Page from '@theme/Page.svelte';\n  import IconText from '@theme/IconText.svelte';\n  import { onMount } from 'svelte';\n  import { slide } from 'svelte/transition';\n  let form: HTMLFormElement;\n  let phoneMessage = '';\n  const validatePhone = async (phone: string) => {\n    console.log(phone);\n    if (!phone) return '';\n    if (phone.startsWith('+91') && phone.length < 14) {\n      return 'Indian phone numbers must contain 10 digits';\n    }\n    if (phone.startsWith('0') && phone.length < 13) {\n      return 'Local landline numbers must contain 11 digits';\n    }\n    const clientCheck = await action('checkPhone', { phone });\n    if (!clientCheck) {\n      return '';\n    } else {\n      return 'This number is being used by ' + clientCheck;\n    }\n  };\n  function onPhoneChange(this: HTMLInputElement) {\n    validatePhone(this.value).then(val => this.setCustomValidity((phoneMessage = val)));\n  }\n  const onPhoneChangeDeb = debounce(onPhoneChange);\n  function onPhoneInput(this: HTMLInputElement) {\n    if (!this.value) return;\n    let ph: string = this.value;\n    ph = (ph.startsWith('+') ? '+' : '') + ph.replace(/[^0-9]/g, '').trim();\n    if (!(ph.startsWith('+') || ph.startsWith('0'))) ph = '+91' + ph;\n    if (ph.startsWith('+91') && ph.length > 3) ph = '+91 ' + ph.slice(3, 13);\n    if (ph.startsWith('0')) {\n      if (ph.length > 5) ph = ph.slice(0, 5) + '-' + ph.slice(5, 11);\n      if (ph.length > 9) ph = ph.slice(0, 9) + '-' + ph.slice(9, 12);\n    }\n    this.value = ph;\n    onPhoneChangeDeb.apply(this);\n  }\n  onMount(() =>\n    form.addEventListener('submit', ev => {\n      ev.preventDefault();\n      const formData = new FormData(form);\n      action('createClient', {\n        name: formData.get('name'),\n        phone: formData.get('phone'),\n        address: formData.get('address'),\n      }).then(val => {\n        if (!val.uuid) {\n          alert('Client not created');\n        }\n        window['svelte-router'].router?.route('/clients');\n      });\n    })\n  );\n</script>\n\n<template>\n  <Page heading=\"Create a new Client\" backButton>\n    <div slot=\"top-extra\">\n      <!-- svelte-ignore a11y-invalid-attribute -->\n      <a href={window.bURL + '/clients'} class=\"t-a-btn\"><IconText icon=\"close\">Close</IconText></a>\n    </div>\n    <section class=\"t-shadow\">\n      <form bind:this={form}>\n        <label for=\"name\">Name</label>\n        <input name=\"name\" type=\"text\" autocomplete=\"off\" minlength=\"3\" required />\n        <label for=\"phone\">Phone number</label>\n        <input name=\"phone\" autocomplete=\"off\" required on:input={onPhoneInput} on:change={onPhoneChange} type=\"text\" />\n        {#if phoneMessage}\n          <div class=\"message\" transition:slide>{phoneMessage}</div>\n        {/if}\n        <label for=\"address\">Address</label>\n        <textarea name=\"address\" autocomplete=\"address-level4\" required />\n        <input type=\"submit\" value=\"Submit\" class=\"t-btn\" />\n      </form>\n    </section>\n  </Page>\n</template>\n\n<style lang=\"scss\">\n  section {\n    padding: 10px;\n    margin: 10px auto;\n    max-width: 600px;\n    overflow: hidden;\n    form {\n      max-width: 500px;\n      margin: 25px auto;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { slide as trns } from 'svelte/transition';\n  import getStore from './TStore';\n  const store = getStore();\n  let store_mobile = store.mobile;\n  store.drawer.set(!$store_mobile);\n  export let backButton: boolean = false;\n  export let heading: string;\n  document.body.scrollTop = 0;\n  document.documentElement.scrollTop = 0;\n</script>\n\n<template>\n  <div class=\"page\" transition:trns>\n    <div class=\"top\">\n      {#if backButton}\n        <!-- svelte-ignore a11y-invalid-attribute -->\n        <a href=\"javascript:history.back()\" class=\"t-a-btn\"><span class=\"material-icons\">arrow_back</span></a>\n      {/if}\n      <div class=\"heading\">{heading}</div>\n      <slot name=\"top-extra\" />\n    </div>\n\n    <div class=\"content\">\n      <slot />\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\">\n  @import './scheme.scss';\n  .page {\n    margin: 0px;\n    padding: 10px;\n    transition: padding $aniDuration ease;\n    @media only screen and (max-width: 720px) {\n      padding: 10px 5px;\n    }\n    .top {\n      color: $textOnBackground;\n      .t-a-btn {\n        height: 34px;\n        display: inline-block;\n        box-sizing: border-box;\n        border-radius: 17px;\n        width: 34px;\n      }\n      .heading {\n        font-size: 1.5em;\n      }\n      border-bottom: solid 2px $textOnBackground;\n      padding: 10px;\n      display: flex;\n      flex-flow: row nowrap;\n      align-items: center;\n      justify-content: space-between;\n      div {\n        display: inline-block;\n      }\n    }\n    .content {\n      padding: 10px;\n      transition: padding $aniDuration ease;\n      @media only screen and (max-width: 720px) {\n        padding: 10px 0px;\n      }\n    }\n  }\n</style>\n","export function debounce<Params extends any[], Context extends any>(\n  func: (this: Context, ...args: Params) => any,\n  delay: number = 700\n): (this: Context, ...args: Params) => void {\n  let debounceTimer: any;\n  return function (this: Context, ...args: Params) {\n    const context = this;\n    clearTimeout(debounceTimer);\n    debounceTimer = setTimeout(() => func.apply(context, args), delay);\n  };\n}\n"],"names":["window","bURL","form","phoneMessage","onPhoneChange","phone","this","value","console","log","startsWith","length","clientCheck","action","then","val","setCustomValidity","onPhoneChangeDeb","debounce","onMount","addEventListener","ev","preventDefault","formData","FormData","name","get","address","uuid","alert","router","route","ph","replace","trim","slice","apply","store","store_mobile","mobile","drawer","set","$store_mobile","backButton","heading","document","body","scrollTop","documentElement","func","delay","debounceTimer","args","context","clearTimeout","setTimeout"],"sourceRoot":""}